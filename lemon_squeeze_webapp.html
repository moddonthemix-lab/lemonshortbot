<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üçã Lemon Squeeze v2.0</title>
    <style>
        :root {
            /* Dark theme colors (default) */
            --bg-main: #1a2332;
            --bg-header: #0f1419;
            --bg-card: #243447;
            --bg-tabs: #1a2332;
            --text-primary: #ffffff;
            --text-secondary: #b8c5d0;
            --accent-orange: #ff9500;
            --accent-coral: #ff6b6b;
            --border-color: #ff9500;
            --shadow: rgba(0,0,0,0.3);
            --shadow-heavy: rgba(0,0,0,0.5);
        }
        
        [data-theme="light"] {
            /* Light mode colors */
            --bg-main: #f5f7fa;
            --bg-header: #ffffff;
            --bg-card: #ffffff;
            --bg-tabs: #ffffff;
            --text-primary: #1a2332;
            --text-secondary: #6b7280;
            --accent-orange: #ff9500;
            --accent-coral: #ff6b6b;
            --border-color: #e5e7eb;
            --shadow: rgba(0,0,0,0.1);
            --shadow-heavy: rgba(0,0,0,0.2);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-main);
            min-height: 100vh;
            padding: 0;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
            background: var(--bg-main);
            overflow: hidden;
        }
        
        .header {
            background: var(--bg-header);
            color: var(--text-primary);
            padding: 40px;
            text-align: center;
            border-bottom: 2px solid var(--accent-orange);
        }
        
        .header h1 {
            font-size: 3.5em;
            margin-bottom: 10px;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .header p {
            font-size: 1.3em;
            opacity: 0.8;
            font-style: italic;
            color: var(--text-secondary);
            margin-bottom: 15px;
        }
        
        .version-badge {
            display: inline-block;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 0.9em;
            font-weight: bold;
            margin-top: 10px;
        }
        
        .toolbar {
            background: var(--bg-header);
            padding: 20px 40px;
            display: flex;
            justify-content: center;
            gap: 20px;
            border-bottom: 1px solid rgba(255, 149, 0, 0.2);
        }
        
        .favorites-toggle,
        .dark-mode-toggle {
            background: var(--accent-orange);
            border: 2px solid var(--accent-orange);
            border-radius: 50px;
            padding: 12px 30px;
            cursor: pointer;
            font-size: 1em;
            display: flex;
            align-items: center;
            gap: 10px;
            color: white;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        [data-theme="light"] .dark-mode-toggle {
            background: transparent;
            color: var(--text-primary);
        }
        
        .dark-mode-toggle:hover,
        .favorites-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 149, 0, 0.4);
        }
        
        .tabs {
            background: var(--bg-tabs);
            padding: 0;
            display: flex;
            justify-content: flex-start;
            gap: 0;
            border-bottom: 2px solid var(--accent-orange);
            overflow-x: auto;
        }
        
        .tab-button {
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            padding: 20px 35px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            color: var(--text-secondary);
            font-weight: 600;
            white-space: nowrap;
            position: relative;
        }
        
        .tab-button:hover {
            color: var(--text-primary);
            background: rgba(255, 149, 0, 0.1);
        }
        
        .tab-button.active {
            color: var(--accent-orange);
            background: transparent;
            border-bottom: 3px solid var(--accent-orange);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .content {
            padding: 40px;
            background: var(--bg-main);
        }
        
        .settings-panel {
            background: var(--bg-card);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px var(--shadow);
            color: var(--text-primary);
            border: 1px solid rgba(255, 149, 0, 0.2);
        }
        
        .settings-panel h2 {
            color: var(--accent-orange);
            font-size: 2em;
            margin-bottom: 20px;
        }
        
        .info-box {
            background: rgba(255, 149, 0, 0.1);
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid var(--accent-orange);
        }
        
        .info-box ul {
            margin-top: 10px;
            margin-left: 20px;
            line-height: 1.8;
            font-size: 1.1em;
            color: var(--text-primary);
        }
        
        .info-box p {
            margin-top: 15px;
            padding: 10px;
            background: rgba(0,0,0,0.2);
            border-radius: 5px;
            font-style: italic;
            color: var(--text-secondary);
        }
        
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .setting-item label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--text-primary);
        }
        
        .setting-item input {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(255, 149, 0, 0.3);
            border-radius: 10px;
            font-size: 1.1em;
            background: rgba(0,0,0,0.2);
            color: var(--text-primary);
        }
        
        .setting-item input:focus {
            outline: none;
            border-color: var(--accent-orange);
        }
        
        .scan-button {
            width: 100%;
            padding: 20px;
            font-size: 1.5em;
            font-weight: bold;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            margin: 20px 0;
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
        }
        
        .scan-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(16, 185, 129, 0.4);
        }
        
        .scan-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 60px;
            background: var(--bg-card);
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 4px 15px var(--shadow);
            border: 1px solid rgba(255, 149, 0, 0.2);
        }
        
        .loading.active {
            display: block;
        }
        
        .spinner {
            width: 80px;
            height: 80px;
            margin: 0 auto 30px;
            border: 8px solid rgba(255, 149, 0, 0.2);
            border-top: 8px solid var(--accent-orange);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            font-size: 1.5em;
            color: var(--text-primary);
            font-weight: bold;
        }
        
        .results {
            display: none;
        }
        
        .results.active {
            display: block;
        }
        
        .results-header {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
        }
        
        .results-header h2 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .stock-card {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px var(--shadow);
            transition: all 0.3s;
            border: 1px solid rgba(255, 149, 0, 0.2);
        }
        
        .stock-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px var(--shadow-heavy);
            border-color: var(--accent-orange);
        }
        
        .stock-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 149, 0, 0.2);
        }
        
        .stock-ticker {
            font-size: 2em;
            font-weight: bold;
            color: var(--accent-orange);
        }
        
        .stock-company {
            font-size: 1.2em;
            color: var(--text-secondary);
            margin-top: 5px;
        }
        
        .risk-badge {
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 1.2em;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .risk-good {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }
        
        .risk-warning {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: white;
        }
        
        .risk-danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .metric-section h4 {
            color: var(--accent-orange);
            font-size: 1.3em;
            margin-bottom: 12px;
        }
        
        .metric-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 149, 0, 0.1);
        }
        
        .metric-label {
            color: var(--text-secondary);
            font-weight: 600;
        }
        
        .metric-value {
            color: var(--text-primary);
            font-weight: bold;
            font-size: 1.1em;
        }
        
        .price-positive {
            color: #10b981;
        }
        
        .price-negative {
            color: #ef4444;
        }
        
        .disclaimer {
            background: var(--bg-card);
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            border-left: 5px solid #ef4444;
            color: var(--text-primary);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        
        .no-results {
            text-align: center;
            padding: 80px 40px;
            background: var(--bg-card);
            border-radius: 15px;
            color: var(--text-primary);
            border: 1px solid rgba(255, 149, 0, 0.2);
        }
        
        .no-results h3 {
            font-size: 2em;
            color: var(--accent-orange);
        }
        
        .scan-section {
            margin: 30px 0;
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }
        
        /* Multi-Timeframe Table Styles */
        .timeframe-table {
            width: 100%;
            border-collapse: collapse;
            background: var(--bg-card);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 15px var(--shadow);
            margin-bottom: 20px;
            border: 1px solid rgba(255, 149, 0, 0.2);
        }
        
        .timeframe-table thead {
            background: rgba(255, 149, 0, 0.2);
            color: var(--text-primary);
        }
        
        .timeframe-table th {
            padding: 18px;
            text-align: left;
            font-size: 1.1em;
            font-weight: bold;
            border-bottom: 2px solid var(--accent-orange);
        }
        
        .timeframe-table td {
            padding: 15px 18px;
            border-bottom: 1px solid rgba(255, 149, 0, 0.1);
            color: var(--text-primary);
        }
        
        .timeframe-table tr:hover {
            background: rgba(255, 149, 0, 0.05);
        }
        
        .strength-badge {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.1em;
        }
        
        .strength-3 {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
            animation: pulse 2s ease-in-out infinite;
        }
        
        .strength-2 {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(251, 191, 36, 0.4);
        }
        
        .strength-1 {
            background: linear-gradient(135deg, #94a3b8 0%, #64748b 100%);
            color: white;
        }
        
        .pattern-indicator {
            padding: 6px 12px;
            border-radius: 10px;
            font-weight: 600;
            font-size: 0.95em;
            display: inline-block;
        }
        
        .pattern-bullish {
            background: #10b981;
            color: white;
        }
        
        .pattern-bearish {
            background: #ef4444;
            color: white;
        }
        
        .pattern-neutral {
            background: #64748b;
            color: white;
        }
        
        .pattern-none {
            color: var(--text-secondary);
            font-size: 1.2em;
        }
    </style>
</head>
<body data-theme="dark">
    <div class="container">
        <div class="header">
            <h1>üçã Lemon Squeeze v2.0</h1>
            <p>Multi-Timeframe Scanner: Stocks & Crypto</p>
            <div class="version-badge">v2.0 - Hourly ‚Ä¢ Daily ‚Ä¢ Weekly ‚Ä¢ Crypto</div>
        </div>
        
        <div class="toolbar">
            <button class="favorites-toggle" onclick="toggleFavorites()">
                <span>‚≠ê</span>
                <span>Favorites</span>
                <span style="background: white; border-radius: 50%; width: 20px; height: 20px; display: inline-block;"></span>
            </button>
            <button class="dark-mode-toggle" onclick="toggleDarkMode()">
                <span id="themeIcon">‚òÄÔ∏è</span>
                <span id="themeText">Light</span>
            </button>
        </div>
        
        <div class="tabs">
            <button class="tab-button active" onclick="switchTab('squeeze')">
                üçã Short Squeeze
            </button>
            <button class="tab-button" onclick="switchTab('findaplay')">
                üéØ Find A Play
            </button>
            <button class="tab-button" onclick="switchTab('crypto')">
                ‚Çø Crypto
            </button>
            <button class="tab-button" onclick="switchTab('volemon')">
                üîä Volemon
            </button>
            <button class="tab-button" onclick="switchTab('usuals')">
                ‚≠ê Usuals
            </button>
        </div>
        
        <!-- Short Squeeze Tab -->
        <div id="squeezeTab" class="tab-content active">
            <div class="content">
                <div class="settings-panel">
                    <h2>üçã Short Squeeze Scanner Settings</h2>
                    <div class="settings-grid">
                        <div class="setting-item">
                            <label for="minShortInterest">Min Short Interest %</label>
                            <input type="number" id="minShortInterest" value="15" min="0" max="100">
                        </div>
                        <div class="setting-item">
                            <label for="maxPrice">Max Stock Price ($)</label>
                            <input type="number" id="maxPrice" value="50" min="1" max="1000">
                        </div>
                        <div class="setting-item">
                            <label for="minVolume">Min Volume</label>
                            <input type="number" id="minVolume" value="500000" min="0">
                        </div>
                        <div class="setting-item">
                            <label for="minMarketCap">Min Market Cap ($M)</label>
                            <input type="number" id="minMarketCap" value="100" min="0">
                        </div>
                    </div>
                </div>
                
                <div class="scan-section">
                    <button id="squeezeButton" class="scan-button" onclick="startSqueezeScan()">
                        üçã START SQUEEZE SCAN! üçã
                    </button>
                </div>
                
                <div id="squeezeLoading" class="loading">
                    <div class="spinner"></div>
                    <div class="loading-text">Scanning for short squeezes... üçã</div>
                </div>
                
                <div id="squeezeResults" class="results"></div>
                
                <div class="disclaimer">
                    <strong>‚ö†Ô∏è IMPORTANT DISCLAIMER</strong>
                    Short squeeze plays are extremely high risk! This scanner is for educational purposes only.
                    Always do your own research and never invest more than you can afford to lose. This is NOT financial advice!
                </div>
            </div>
        </div>
        
        <!-- Find A Play Tab (Multi-Timeframe) -->
        <div id="findaplayTab" class="tab-content">
            <div class="content">
                <div class="settings-panel">
                    <h2>üìö The 3-1 Strat Pattern (Multi-Timeframe Analysis)</h2>
                    <div class="info-box">
                        <ul>
                            <li><strong>"3" = Outside Bar:</strong> Higher high + lower low than previous candle (expansion)</li>
                            <li><strong>"1" = Inside Bar:</strong> Lower high + higher low than previous candle (consolidation)</li>
                            <li><strong>Multi-Timeframe:</strong> Checks Daily, Weekly, AND Hourly patterns all at once</li>
                            <li><strong>Strength Scoring:</strong> ‚≠ê‚≠ê‚≠ê = Pattern on all 3 timeframes (STRONGEST signal)</li>
                        </ul>
                        <p>
                            üéØ Professional traders ALWAYS check multiple timeframes. This scanner does it for you automatically!
                        </p>
                    </div>
                </div>
                
                <div class="scan-section">
                    <button id="findaplayButton" class="scan-button" onclick="startFindAPlayScan()">
                        üéØ FIND A PLAY - SCAN ALL TIMEFRAMES! üçã
                    </button>
                </div>
                
                <div id="findaplayLoading" class="loading">
                    <div class="spinner"></div>
                    <div class="loading-text">Scanning 47 stocks across 3 timeframes... üéØ</div>
                </div>
                
                <div id="findaplayResults" class="results"></div>
                
                <div class="disclaimer">
                    <strong>‚ö†Ô∏è IMPORTANT DISCLAIMER</strong>
                    Multi-timeframe analysis provides powerful confirmation but does not guarantee success. Markets are unpredictable and pattern failures are common.
                    Always use proper risk management, set stop losses, and never risk more than you can afford to lose. This is NOT financial advice!
                </div>
            </div>
        </div>
        
        <!-- Crypto Tab -->
        <div id="cryptoTab" class="tab-content">
            <div class="content">
                <div class="settings-panel">
                    <h2>‚Çø Crypto Scanner</h2>
                    <p style="font-size: 1.2em; color: var(--text-primary);">
                        Scan top cryptocurrencies for trading opportunities!
                    </p>
                </div>
                
                <div class="scan-section">
                    <button id="cryptoButton" class="scan-button" onclick="startCryptoScan()">
                        ‚Çø SCAN CRYPTO MARKET! üçã
                    </button>
                </div>
                
                <div id="cryptoLoading" class="loading">
                    <div class="spinner"></div>
                    <div class="loading-text">Scanning crypto market... ‚Çø</div>
                </div>
                
                <div id="cryptoResults" class="results"></div>
                
                <div class="disclaimer">
                    <strong>‚ö†Ô∏è IMPORTANT DISCLAIMER</strong>
                    Cryptocurrency trading is extremely volatile and risky. Only invest what you can afford to lose.
                    This is NOT financial advice!
                </div>
            </div>
        </div>
        
        <!-- Volemon Tab -->
        <div id="volemonTab" class="tab-content">
            <div class="content">
                <div class="settings-panel">
                    <h2>üîä Volemon Scanner</h2>
                    <p style="font-size: 1.2em; color: var(--text-primary); margin-bottom: 20px;">
                        Find penny stocks with unusual volume spikes!
                    </p>
                    <div class="settings-grid">
                        <div class="setting-item">
                            <label for="minVolumeMultiple">Min Volume Multiple</label>
                            <input type="number" id="minVolumeMultiple" value="3" min="1" max="10" step="0.5">
                        </div>
                    </div>
                </div>
                
                <div class="scan-section">
                    <button id="volemonButton" class="scan-button" onclick="startVolemonScan()">
                        üîä SCAN FOR VOLUME SPIKES! üçã
                    </button>
                </div>
                
                <div id="volemonLoading" class="loading">
                    <div class="spinner"></div>
                    <div class="loading-text">Scanning for volume spikes... üîä</div>
                </div>
                
                <div id="volemonResults" class="results"></div>
                
                <div class="disclaimer">
                    <strong>‚ö†Ô∏è IMPORTANT DISCLAIMER</strong>
                    Penny stocks and volume spikes are extremely high risk. Many are subject to manipulation.
                    This is NOT financial advice!
                </div>
            </div>
        </div>
        
        <!-- Usuals Tab -->
        <div id="usualsTab" class="tab-content">
            <div class="content">
                <div class="settings-panel">
                    <h2>‚≠ê Usuals Watchlist</h2>
                    <p style="font-size: 1.2em; color: var(--text-primary);">
                        Your custom watchlist of favorite stocks!
                    </p>
                </div>
                
                <div class="scan-section">
                    <button id="usualsButton" class="scan-button" onclick="startUsualsScan()">
                        ‚≠ê SCAN WATCHLIST! üçã
                    </button>
                </div>
                
                <div id="usualsLoading" class="loading">
                    <div class="spinner"></div>
                    <div class="loading-text">Scanning watchlist... ‚≠ê</div>
                </div>
                
                <div id="usualsResults" class="results"></div>
                
                <div class="disclaimer">
                    <strong>‚ö†Ô∏è IMPORTANT DISCLAIMER</strong>
                    This watchlist is for tracking purposes only. Always do your own research.
                    This is NOT financial advice!
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Dark mode toggle
        function toggleDarkMode() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            html.setAttribute('data-theme', newTheme);
            
            const icon = document.getElementById('themeIcon');
            const text = document.getElementById('themeText');
            
            if (newTheme === 'dark') {
                icon.textContent = '‚òÄÔ∏è';
                text.textContent = 'Light';
            } else {
                icon.textContent = 'üåô';
                text.textContent = 'Dark';
            }
            
            localStorage.setItem('theme', newTheme);
        }
        
        // Favorites toggle (placeholder)
        function toggleFavorites() {
            alert('Favorites feature coming soon!');
        }
        
        // Load saved theme
        window.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
            
            if (savedTheme === 'dark') {
                document.getElementById('themeIcon').textContent = '‚òÄÔ∏è';
                document.getElementById('themeText').textContent = 'Light';
            } else {
                document.getElementById('themeIcon').textContent = 'üåô';
                document.getElementById('themeText').textContent = 'Dark';
            }
        });
        
        // Tab switching
        function switchTab(tabName) {
            // Hide all tabs
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Remove active class from all buttons
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            // Show selected tab
            document.getElementById(tabName + 'Tab').classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
        }
        
        // Short Squeeze Scanner
        async function startSqueezeScan() {
            const loading = document.getElementById('squeezeLoading');
            const results = document.getElementById('squeezeResults');
            const button = document.getElementById('squeezeButton');
            
            loading.classList.add('active');
            results.classList.remove('active');
            button.disabled = true;
            button.textContent = 'üçã SCANNING...';
            
            try {
                const response = await fetch('/api/squeeze-scan', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        min_short_interest: document.getElementById('minShortInterest').value,
                        max_price: document.getElementById('maxPrice').value,
                        min_volume: document.getElementById('minVolume').value,
                        min_market_cap: document.getElementById('minMarketCap').value
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    displaySqueezeResults(data.results);
                } else {
                    results.innerHTML = '<div class="no-results"><h3>Error: ' + data.error + '</h3></div>';
                    results.classList.add('active');
                }
            } catch (error) {
                results.innerHTML = '<div class="no-results"><h3>Error: Unable to connect to server</h3></div>';
                results.classList.add('active');
            } finally {
                loading.classList.remove('active');
                button.disabled = false;
                button.textContent = 'üçã START SQUEEZE SCAN! üçã';
            }
        }
        
        function displaySqueezeResults(stocks) {
            const results = document.getElementById('squeezeResults');
            
            if (stocks.length === 0) {
                results.innerHTML = '<div class="no-results"><h3>üçã No Short Squeeze Candidates Found</h3><p>Try adjusting your filter settings</p></div>';
                results.classList.add('active');
                return;
            }
            
            let html = '<div class="results-header"><h2>üçã ' + stocks.length + ' Potential Squeezes Found!</h2></div>';
            
            stocks.forEach(stock => {
                const riskClass = stock.risk_score < 3 ? 'risk-good' : 
                                 stock.risk_score < 5 ? 'risk-warning' : 'risk-danger';
                const riskText = stock.risk_score < 3 ? 'LOW RISK' : 
                                stock.risk_score < 5 ? 'MEDIUM RISK' : 'HIGH RISK';
                
                html += `
                    <div class="stock-card">
                        <div class="stock-header">
                            <div>
                                <div class="stock-ticker">${stock.ticker}</div>
                                <div class="stock-company">${stock.company}</div>
                            </div>
                            <div class="risk-badge ${riskClass}">${riskText}</div>
                        </div>
                        <div class="metrics-grid">
                            <div class="metric-section">
                                <h4>Price Action</h4>
                                <div class="metric-item">
                                    <span class="metric-label">Current Price</span>
                                    <span class="metric-value">$${stock.price.toFixed(2)}</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Change</span>
                                    <span class="metric-value ${stock.change >= 0 ? 'price-positive' : 'price-negative'}">
                                        ${stock.change >= 0 ? '+' : ''}${stock.change.toFixed(2)}%
                                    </span>
                                </div>
                            </div>
                            <div class="metric-section">
                                <h4>Short Interest</h4>
                                <div class="metric-item">
                                    <span class="metric-label">Short %</span>
                                    <span class="metric-value">${stock.short_percent.toFixed(2)}%</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Days to Cover</span>
                                    <span class="metric-value">${stock.days_to_cover.toFixed(1)}</span>
                                </div>
                            </div>
                            <div class="metric-section">
                                <h4>Volume</h4>
                                <div class="metric-item">
                                    <span class="metric-label">Current</span>
                                    <span class="metric-value">${(stock.volume / 1000000).toFixed(1)}M</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Avg Volume</span>
                                    <span class="metric-value">${(stock.avg_volume / 1000000).toFixed(1)}M</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            results.innerHTML = html;
            results.classList.add('active');
        }
        
        // Find A Play Scanner (Multi-Timeframe)
        async function startFindAPlayScan() {
            const loading = document.getElementById('findaplayLoading');
            const results = document.getElementById('findaplayResults');
            const button = document.getElementById('findaplayButton');
            
            loading.classList.add('active');
            results.classList.remove('active');
            button.disabled = true;
            button.textContent = 'üéØ SCANNING...';
            
            try {
                const response = await fetch('/api/find-a-play', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'}
                });
                
                const data = await response.json();
                
                if (data.success) {
                    displayFindAPlayResults(data.results, data.stats);
                } else {
                    results.innerHTML = '<div class="no-results"><h3>Error</h3></div>';
                    results.classList.add('active');
                }
            } catch (error) {
                results.innerHTML = '<div class="no-results"><h3>Error: Unable to connect to server</h3></div>';
                results.classList.add('active');
            } finally {
                loading.classList.remove('active');
                button.disabled = false;
                button.textContent = 'üéØ FIND A PLAY - SCAN ALL TIMEFRAMES! üçã';
            }
        }
        
        function displayFindAPlayResults(plays, stats) {
            const results = document.getElementById('findaplayResults');
            
            if (plays.length === 0) {
                results.innerHTML = '<div class="no-results"><h3>üéØ No Multi-Timeframe Patterns Found</h3></div>';
                results.classList.add('active');
                return;
            }
            
            let html = `
                <div class="results-header">
                    <h2>üéØ ${plays.length} Multi-Timeframe Plays Found!</h2>
                    <p style="margin-top: 15px; font-size: 1.2em;">
                        ‚≠ê‚≠ê‚≠ê 3-Star: ${stats.three_star} plays | 
                        ‚≠ê‚≠ê 2-Star: ${stats.two_star} plays | 
                        ‚≠ê 1-Star: ${stats.one_star} plays
                    </p>
                </div>
                
                <table class="timeframe-table">
                    <thead>
                        <tr>
                            <th>Strength</th>
                            <th>Ticker</th>
                            <th>Company</th>
                            <th>Price</th>
                            <th>Change</th>
                            <th>Daily</th>
                            <th>Weekly</th>
                            <th>Hourly</th>
                            <th>Volume</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            plays.forEach(play => {
                const strengthClass = `strength-${play.strength}`;
                const stars = '‚≠ê'.repeat(play.strength);
                const changeClass = play.dailyChange >= 0 ? 'price-positive' : 'price-negative';
                
                html += `
                    <tr>
                        <td><span class="strength-badge ${strengthClass}">${stars}</span></td>
                        <td><strong>${play.ticker}</strong></td>
                        <td style="font-size: 0.9em;">${play.company}</td>
                        <td><strong>$${play.currentPrice.toFixed(2)}</strong></td>
                        <td class="${changeClass}">${play.dailyChange >= 0 ? '+' : ''}${play.dailyChange.toFixed(2)}%</td>
                        <td>${formatPattern(play.patterns.daily)}</td>
                        <td>${formatPattern(play.patterns.weekly)}</td>
                        <td>${formatPattern(play.patterns.hourly)}</td>
                        <td>${(play.volume / 1000000).toFixed(1)}M</td>
                    </tr>
                `;
            });
            
            html += '</tbody></table>';
            
            results.innerHTML = html;
            results.classList.add('active');
        }
        
        function formatPattern(pattern) {
            if (!pattern) {
                return '<span class="pattern-none">-</span>';
            }
            
            const arrow = pattern.direction === 'bullish' ? '‚Üë' : '‚Üì';
            const patternClass = pattern.direction === 'bullish' ? 'pattern-bullish' : 'pattern-bearish';
            
            return `<span class="pattern-indicator ${patternClass}">3-1 ${arrow}</span>`;
        }
        
        // Crypto Scanner
        async function startCryptoScan() {
            const loading = document.getElementById('cryptoLoading');
            const results = document.getElementById('cryptoResults');
            const button = document.getElementById('cryptoButton');
            
            loading.classList.add('active');
            results.classList.remove('active');
            button.disabled = true;
            button.textContent = '‚Çø SCANNING...';
            
            try {
                const response = await fetch('/api/crypto-scan', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'}
                });
                
                const data = await response.json();
                
                if (data.success) {
                    displayCryptoResults(data.results);
                } else {
                    results.innerHTML = '<div class="no-results"><h3>Error</h3></div>';
                    results.classList.add('active');
                }
            } catch (error) {
                results.innerHTML = '<div class="no-results"><h3>Error</h3></div>';
                results.classList.add('active');
            } finally {
                loading.classList.remove('active');
                button.disabled = false;
                button.textContent = '‚Çø SCAN CRYPTO MARKET! üçã';
            }
        }
        
        function displayCryptoResults(cryptos) {
            const results = document.getElementById('cryptoResults');
            
            if (cryptos.length === 0) {
                results.innerHTML = '<div class="no-results"><h3>‚Çø No Crypto Data Available</h3></div>';
                results.classList.add('active');
                return;
            }
            
            let html = '<div class="results-header"><h2>‚Çø ' + cryptos.length + ' Cryptocurrencies Scanned</h2></div>';
            
            cryptos.forEach(crypto => {
                html += `
                    <div class="stock-card">
                        <div class="stock-header">
                            <div>
                                <div class="stock-ticker">${crypto.symbol}</div>
                                <div class="stock-company">${crypto.name}</div>
                            </div>
                        </div>
                        <div class="metrics-grid">
                            <div class="metric-section">
                                <h4>Price</h4>
                                <div class="metric-item">
                                    <span class="metric-label">Current</span>
                                    <span class="metric-value">$${crypto.currentPrice.toFixed(2)}</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Change</span>
                                    <span class="metric-value ${crypto.change >= 0 ? 'price-positive' : 'price-negative'}">
                                        ${crypto.change >= 0 ? '+' : ''}${crypto.change.toFixed(2)}%
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            results.innerHTML = html;
            results.classList.add('active');
        }
        
        // Volemon Scanner
        async function startVolemonScan() {
            const loading = document.getElementById('volemonLoading');
            const results = document.getElementById('volemonResults');
            
            loading.classList.add('active');
            results.classList.remove('active');
            
            try {
                const response = await fetch('/api/volemon-scan', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        min_volume_multiple: document.getElementById('minVolumeMultiple').value
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    displayVolemonResults(data.results);
                } else {
                    results.innerHTML = '<div class="no-results"><h3>Error</h3></div>';
                    results.classList.add('active');
                }
            } catch (error) {
                results.innerHTML = '<div class="no-results"><h3>Error</h3></div>';
                results.classList.add('active');
            } finally {
                loading.classList.remove('active');
            }
        }
        
        function displayVolemonResults(stocks) {
            const results = document.getElementById('volemonResults');
            
            if (stocks.length === 0) {
                results.innerHTML = '<div class="no-results"><h3>üîä No Volume Spikes Found</h3></div>';
                results.classList.add('active');
                return;
            }
            
            let html = '<div class="results-header"><h2>üîä ' + stocks.length + ' Volume Spikes Found!</h2></div>';
            
            stocks.forEach(stock => {
                html += `
                    <div class="stock-card">
                        <div class="stock-header">
                            <div>
                                <div class="stock-ticker">${stock.ticker}</div>
                                <div class="stock-company">${stock.company}</div>
                            </div>
                            <div class="risk-badge risk-good">${stock.volume_multiple.toFixed(1)}x Volume</div>
                        </div>
                        <div class="metrics-grid">
                            <div class="metric-section">
                                <h4>Price</h4>
                                <div class="metric-item">
                                    <span class="metric-label">Current</span>
                                    <span class="metric-value">$${stock.price.toFixed(2)}</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Change</span>
                                    <span class="metric-value ${stock.change >= 0 ? 'price-positive' : 'price-negative'}">
                                        ${stock.change >= 0 ? '+' : ''}${stock.change.toFixed(2)}%
                                    </span>
                                </div>
                            </div>
                            <div class="metric-section">
                                <h4>Volume</h4>
                                <div class="metric-item">
                                    <span class="metric-label">Current</span>
                                    <span class="metric-value">${(stock.volume / 1000000).toFixed(1)}M</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Average</span>
                                    <span class="metric-value">${(stock.avg_volume / 1000000).toFixed(1)}M</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            results.innerHTML = html;
            results.classList.add('active');
        }
        
        // Usuals Scanner
        async function startUsualsScan() {
            const loading = document.getElementById('usualsLoading');
            const results = document.getElementById('usualsResults');
            
            loading.classList.add('active');
            results.classList.remove('active');
            
            try {
                const response = await fetch('/api/usuals-scan', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'}
                });
                
                const data = await response.json();
                
                if (data.success) {
                    displayUsualsResults(data.results);
                } else {
                    results.innerHTML = '<div class="no-results"><h3>Error</h3></div>';
                    results.classList.add('active');
                }
            } catch (error) {
                results.innerHTML = '<div class="no-results"><h3>Error</h3></div>';
                results.classList.add('active');
            } finally {
                loading.classList.remove('active');
            }
        }
        
        function displayUsualsResults(stocks) {
            const results = document.getElementById('usualsResults');
            
            if (stocks.length === 0) {
                results.innerHTML = '<div class="no-results"><h3>‚≠ê No Stocks Scanned</h3></div>';
                results.classList.add('active');
                return;
            }
            
            let html = '<div class="results-header"><h2>‚≠ê ' + stocks.length + ' Stocks in Watchlist</h2></div>';
            
            stocks.forEach(stock => {
                const hasPattern = stock.patterns && stock.patterns.daily;
                const patternText = hasPattern ? stock.patterns.daily.type : 'No Pattern';
                const patternClass = hasPattern ? (stock.patterns.daily.direction === 'bullish' ? 'pattern-bullish' : 
                                                    stock.patterns.daily.direction === 'bearish' ? 'pattern-bearish' : 'pattern-neutral') : '';
                
                html += `
                    <div class="stock-card">
                        <div class="stock-header">
                            <div>
                                <div class="stock-ticker">${stock.ticker}</div>
                                <div class="stock-company">${stock.company}</div>
                            </div>
                            ${hasPattern ? `<span class="pattern-badge ${patternClass}">${patternText}</span>` : ''}
                        </div>
                        <div class="metrics-grid">
                            <div class="metric-section">
                                <h4>Price</h4>
                                <div class="metric-item">
                                    <span class="metric-label">Current</span>
                                    <span class="metric-value">$${stock.price.toFixed(2)}</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Change</span>
                                    <span class="metric-value ${stock.change >= 0 ? 'price-positive' : 'price-negative'}">
                                        ${stock.change >= 0 ? '+' : ''}${stock.change.toFixed(2)}%
                                    </span>
                                </div>
                            </div>
                            <div class="metric-section">
                                <h4>Volume</h4>
                                <div class="metric-item">
                                    <span class="metric-label">Current</span>
                                    <span class="metric-value">${(stock.volume / 1000000).toFixed(1)}M</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Ratio</span>
                                    <span class="metric-value">${stock.volume_ratio.toFixed(2)}x</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            results.innerHTML = html;
            results.classList.add('active');
        }
    </script>
</body>
</html>
