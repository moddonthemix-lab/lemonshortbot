<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üçã Lemon Squeeze Web App</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1300px;
            margin: 0 auto;
            background: #FFF9E6;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            color: #333;
            padding: 40px;
            text-align: center;
            position: relative;
        }
        
        .header::before, .header::after {
            content: "üçã";
            position: absolute;
            font-size: 100px;
            opacity: 0.1;
            top: 20px;
        }
        
        .header::before { left: 50px; }
        .header::after { right: 50px; }
        
        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        .header p {
            font-size: 1.3em;
            font-style: italic;
            opacity: 0.9;
        }
        
        .badge {
            display: inline-block;
            background: #FF6B6B;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            margin-top: 10px;
            font-weight: bold;
        }
        
        .content {
            padding: 40px;
        }
        
        .settings-panel {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .settings-panel h2 {
            color: #FFA500;
            margin-bottom: 20px;
            font-size: 1.5em;
        }
        
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .setting-item {
            display: flex;
            flex-direction: column;
        }
        
        label {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            font-size: 1.1em;
        }
        
        input[type="number"] {
            padding: 12px;
            border: 3px solid #FFD700;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            transition: all 0.3s;
        }
        
        input[type="number"]:focus {
            outline: none;
            border-color: #FFA500;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
        }
        
        .scan-section {
            text-align: center;
            margin-bottom: 30px;
        }
        
        #scanButton {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            color: #333;
            border: none;
            padding: 25px 60px;
            font-size: 28px;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 8px 25px rgba(255, 165, 0, 0.4);
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        #scanButton:hover:not(:disabled) {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(255, 165, 0, 0.6);
        }
        
        #scanButton:active {
            transform: translateY(-2px);
        }
        
        #scanButton:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .loading.active {
            display: block;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #FFD700;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            font-size: 1.2em;
            color: #666;
            font-weight: 600;
        }
        
        .results {
            display: none;
        }
        
        .results.active {
            display: block;
        }
        
        .results-header {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .results-header h2 {
            color: #FFA500;
            font-size: 2em;
            margin-bottom: 15px;
        }
        
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #FFD700;
            display: block;
        }
        
        .stat-label {
            color: #666;
            font-size: 1em;
            margin-top: 5px;
        }
        
        .no-results {
            background: white;
            padding: 50px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .no-results h3 {
            font-size: 2em;
            color: #FF6B6B;
            margin-bottom: 20px;
        }
        
        .stock-card {
            background: white;
            border: 3px solid #FFD700;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .stock-card::before {
            content: "üçã";
            position: absolute;
            font-size: 150px;
            opacity: 0.05;
            right: -30px;
            top: -30px;
            transform: rotate(-20deg);
        }
        
        .stock-card:hover {
            transform: translateX(10px);
            box-shadow: 0 8px 30px rgba(255, 165, 0, 0.3);
            border-color: #FFA500;
        }
        
        .stock-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .stock-ticker {
            font-size: 2em;
            font-weight: bold;
            color: #FFA500;
        }
        
        .risk-badge {
            padding: 12px 25px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 1.3em;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .risk-extreme { background: linear-gradient(135deg, #FF4500 0%, #FF6347 100%); color: white; }
        .risk-high { background: linear-gradient(135deg, #FF8C00 0%, #FFA500 100%); color: white; }
        .risk-good { background: linear-gradient(135deg, #32CD32 0%, #90EE90 100%); color: white; }
        .risk-moderate { background: linear-gradient(135deg, #4169E1 0%, #87CEEB 100%); color: white; }
        
        .stock-company {
            color: #666;
            margin-bottom: 20px;
            font-size: 1.2em;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .metric-section {
            background: #FFF9E6;
            padding: 15px;
            border-radius: 10px;
        }
        
        .metric-section h4 {
            color: #FFA500;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .metric-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.95em;
        }
        
        .metric-label {
            color: #666;
        }
        
        .metric-value {
            font-weight: bold;
            color: #333;
        }
        
        .disclaimer {
            background: linear-gradient(135deg, #FFF3CD 0%, #FFE5B4 100%);
            border: 3px solid #FFC107;
            border-radius: 15px;
            padding: 20px;
            margin-top: 30px;
            color: #856404;
            text-align: center;
        }
        
        .disclaimer strong {
            display: block;
            font-size: 1.3em;
            margin-bottom: 10px;
        }
        
        @media (max-width: 768px) {
            .header h1 { font-size: 2em; }
            #scanButton { font-size: 20px; padding: 20px 40px; }
            .settings-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üçã LEMON SQUEEZE üçã</h1>
            <p>When Life Gives You Shorts... Squeeze Them!</p>
            <span class="badge">üî¥ LIVE DATA - REAL-TIME SCANNING</span>
        </div>
        
        <div class="content">
            <div class="settings-panel">
                <h2>üìä Scan Settings</h2>
                <div class="settings-grid">
                    <div class="setting-item">
                        <label for="minShort">üéØ Min Short Interest (%)</label>
                        <input type="number" id="minShort" value="25" min="0" max="100" step="1">
                    </div>
                    <div class="setting-item">
                        <label for="minGain">üöÄ Min Daily Gain (%)</label>
                        <input type="number" id="minGain" value="15" min="0" max="1000" step="1">
                    </div>
                    <div class="setting-item">
                        <label for="minVolRatio">üìà Min Volume Ratio</label>
                        <input type="number" id="minVolRatio" value="1.5" min="0" max="100" step="0.1">
                    </div>
                    <div class="setting-item">
                        <label for="minRisk">üéØ Min Risk Score</label>
                        <input type="number" id="minRisk" value="60" min="0" max="100" step="1">
                    </div>
                </div>
                <p style="color: #666; font-size: 0.95em; font-style: italic;">
                    üí° Using LIVE data from Yahoo Finance. Scan takes 2-5 minutes for accurate results.
                </p>
            </div>
            
            <div class="scan-section">
                <button id="scanButton" onclick="startScan()">
                    üîç SCAN FOR SQUEEZES üçã
                </button>
            </div>
            
            <div id="loading" class="loading">
                <div class="spinner"></div>
                <div class="loading-text">Squeezing lemons... üçã</div>
                <div id="loadingProgress" style="margin-top: 10px; color: #999;"></div>
            </div>
            
            <div id="results" class="results"></div>
            
            <div class="disclaimer">
                <strong>‚ö†Ô∏è IMPORTANT DISCLAIMER</strong>
                This tool is for informational and educational purposes only. Short squeezes are extremely high-risk and volatile. 
                Past performance does not guarantee future results. Always conduct your own research (DYOR) and never invest more 
                than you can afford to lose. This is NOT financial advice!
            </div>
        </div>
    </div>
    
    <script>
        let isScanning = false;
        
        async function startScan() {
            if (isScanning) return;
            
            const minShort = parseFloat(document.getElementById('minShort').value);
            const minGain = parseFloat(document.getElementById('minGain').value);
            const minVolRatio = parseFloat(document.getElementById('minVolRatio').value);
            const minRisk = parseFloat(document.getElementById('minRisk').value);
            
            if (isNaN(minShort) || isNaN(minGain) || isNaN(minVolRatio) || isNaN(minRisk)) {
                alert('Please enter valid numbers!');
                return;
            }
            
            isScanning = true;
            document.getElementById('scanButton').disabled = true;
            document.getElementById('scanButton').textContent = '‚è≥ SCANNING...';
            document.getElementById('loading').classList.add('active');
            document.getElementById('results').classList.remove('active');
            
            try {
                const response = await fetch('/api/scan', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        minShort,
                        minGain,
                        minVolRatio,
                        minRisk
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    displayResults(data.results, minShort, minGain, minVolRatio, minRisk);
                } else {
                    alert('Error: ' + data.error);
                }
                
            } catch (error) {
                alert('Error scanning: ' + error.message);
            } finally {
                isScanning = false;
                document.getElementById('scanButton').disabled = false;
                document.getElementById('scanButton').textContent = 'üîç SCAN FOR SQUEEZES üçã';
                document.getElementById('loading').classList.remove('active');
            }
        }
        
        function displayResults(candidates, minShort, minGain, minVolRatio, minRisk) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.classList.add('active');
            
            if (candidates.length === 0) {
                resultsDiv.innerHTML = `
                    <div class="no-results">
                        <h3>üçã No Squeezes Found Today</h3>
                        <p style="font-size: 1.2em; color: #666; margin: 20px 0;">
                            No stocks met the criteria: Short Interest ‚â•${minShort}% AND Daily Gain ‚â•+${minGain}%
                        </p>
                        <p style="color: #999;">
                            üí° Try lowering the thresholds or check back later!<br>
                            The market might just be having a calm day.
                        </p>
                    </div>
                `;
                return;
            }
            
            // Calculate summary stats
            const avgGain = candidates.reduce((sum, s) => sum + s.dailyChange, 0) / candidates.length;
            const maxGain = Math.max(...candidates.map(s => s.dailyChange));
            const avgShort = candidates.reduce((sum, s) => sum + s.shortInterest, 0) / candidates.length;
            const avgRisk = candidates.reduce((sum, s) => sum + s.riskScore, 0) / candidates.length;
            
            let html = `
                <div class="results-header">
                    <h2>üöÄ Squeeze Candidates Found!</h2>
                    <p style="font-size: 1.2em; color: #666; margin: 10px 0;">
                        ${new Date().toLocaleString()}
                    </p>
                    <div class="summary-stats">
                        <div class="stat">
                            <span class="stat-value">${candidates.length}</span>
                            <span class="stat-label">Candidates</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value">${avgRisk.toFixed(1)}</span>
                            <span class="stat-label">Avg Risk Score</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value">+${avgGain.toFixed(2)}%</span>
                            <span class="stat-label">Avg Gain</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value">+${maxGain.toFixed(2)}%</span>
                            <span class="stat-label">Max Gain</span>
                        </div>
                    </div>
                </div>
            `;
            
            candidates.forEach((stock, idx) => {
                let riskClass, riskLabel, riskEmoji;
                if (stock.riskScore >= 90) {
                    riskClass = 'risk-extreme';
                    riskLabel = 'EXTREME';
                    riskEmoji = 'üî•üî•üî•';
                } else if (stock.riskScore >= 80) {
                    riskClass = 'risk-high';
                    riskLabel = 'HIGH';
                    riskEmoji = 'üöÄüöÄ';
                } else if (stock.riskScore >= 70) {
                    riskClass = 'risk-good';
                    riskLabel = 'GOOD';
                    riskEmoji = 'üí™';
                } else {
                    riskClass = 'risk-moderate';
                    riskLabel = 'MODERATE';
                    riskEmoji = '‚úÖ';
                }
                
                html += `
                    <div class="stock-card">
                        <div class="stock-header">
                            <div class="stock-ticker">#${idx + 1}. ${stock.ticker}</div>
                            <div class="risk-badge ${riskClass}">
                                ${stock.riskScore}/100 ${riskEmoji}
                            </div>
                        </div>
                        <div class="stock-company">${stock.company}</div>
                        
                        <div class="metrics-grid">
                            <div class="metric-section">
                                <h4>üìä Core Metrics</h4>
                                <div class="metric-item">
                                    <span class="metric-label">Short Interest:</span>
                                    <span class="metric-value">${stock.shortInterest.toFixed(2)}%</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Daily Gain:</span>
                                    <span class="metric-value" style="color: #10b981;">+${stock.dailyChange.toFixed(2)}%</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Price Move:</span>
                                    <span class="metric-value">$${stock.previousClose.toFixed(2)} ‚Üí $${stock.currentPrice.toFixed(2)}</span>
                                </div>
                            </div>
                            
                            <div class="metric-section">
                                <h4>üìà Volume Analysis</h4>
                                <div class="metric-item">
                                    <span class="metric-label">Current Vol:</span>
                                    <span class="metric-value">${stock.volume.toLocaleString()}</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Avg Volume:</span>
                                    <span class="metric-value">${stock.avgVolume.toLocaleString()}</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Volume Ratio:</span>
                                    <span class="metric-value">${stock.volumeRatio.toFixed(2)}x ${stock.volumeRatio >= 3 ? 'üî•' : stock.volumeRatio >= 2 ? 'üöÄ' : '‚úÖ'}</span>
                                </div>
                            </div>
                            
                            <div class="metric-section">
                                <h4>‚öôÔ∏è Squeeze Mechanics</h4>
                                <div class="metric-item">
                                    <span class="metric-label">Float:</span>
                                    <span class="metric-value">${(stock.floatShares / 1000000).toFixed(1)}M</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Days to Cover:</span>
                                    <span class="metric-value">${stock.daysToCover.toFixed(2)} ${stock.daysToCover >= 5 ? 'üöÄ' : '‚úÖ'}</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Market Cap:</span>
                                    <span class="metric-value">${(stock.marketCap / 1000000).toFixed(1)}M</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            resultsDiv.innerHTML = html;
        }
    </script>
</body>
</html>
